SELECT el.id, el.date_created, el.passcode, el.weight, el.height, el.age, el.bmi, 
	IF(el.is_eligible = 1, 'Yes', 'No') is_eligible,
	IF(el.high_speed_internet = 1, 'Yes', 'No') high_speed_internet,
	IF(ISNULL(el.can_understand_english), 'N/A', IF(el.can_understand_english = 1, 'Yes', 'No')) can_understand_english,
	q.`question`,
	IF(res.answer = 2, 'No', "Yes") answer
		FROM `genwp_genesis_eligibility_result_answers` res
			LEFT JOIN `genwp_genesis_eligibility_result` el
		ON res.`result_id` = el.`id`
			INNER JOIN `genwp_genesis_eligibility_questions` q
		ON res.question_id = q.id
	WHERE is_eligible = 0

	ORDER BY el.id, q.`id`

// IS NOT ELIGIBLE, WITH SURVEY DATA (POSTCODE, ETHNICITY, GENE)
SELECT 
	allData.*,
	IF(survey_postcode.user_answer IS NULL, "", survey_postcode.user_answer) AS eligibility_survey_postcode,	
	IF(survey_ethnicity_answer.answer IS NULL, "", survey_ethnicity_answer.answer)  AS eligibility_survey_ethnicity,
	IF(survey_carry_gene_answer.answer IS NULL, "", survey_carry_gene_answer.answer) AS eligibility_survey_brca_gene
	FROM (
SELECT el.id, el.date_created, el.passcode, el.weight, el.height, el.age, el.bmi, 
	IF(el.is_eligible = 1, 'Yes', 'No') is_eligible,
	IF(el.high_speed_internet = 1, 'Yes', 'No') high_speed_internet,
	IF(ISNULL(el.can_understand_english), 'N/A', IF(el.can_understand_english = 1, 'Yes', 'No')) can_understand_english,
	q.`question`,
	IF(res.answer = 2, 'No', "Yes") answer
		FROM `genwp_genesis_eligibility_result_answers` res
			LEFT JOIN `genwp_genesis_eligibility_result` el
		ON res.`result_id` = el.`id`
			INNER JOIN `genwp_genesis_eligibility_questions` q
		ON res.question_id = q.id
	WHERE is_eligible = 0

	ORDER BY el.id, q.`id`
) as allData
	LEFT JOIN genwp_surveys_result_answer survey_result
		ON allData.id = survey_result.`user_answer`
		/* 98 = eligibility_id hidden field */
			AND survey_result.`question_ID` = 98
	LEFT JOIN genwp_surveys_result_answer survey_postcode
		ON survey_postcode.`result_ID` = survey_result.`result_ID`
			AND survey_postcode.`question_ID` = 95  /* Postcode */
	LEFT JOIN genwp_surveys_result_answer survey_ethnicity
		ON survey_ethnicity.`result_ID` = survey_result.`result_ID`
			AND survey_ethnicity.`question_ID` = 96 /* Ethnicity */
	LEFT JOIN genwp_surveys_answer survey_ethnicity_answer
		ON survey_ethnicity_answer.`ID` = survey_ethnicity.`answer_ID`
	LEFT JOIN genwp_surveys_result_answer survey_carry_gene
		ON survey_carry_gene.`result_ID` = survey_result.`result_ID`
			AND survey_carry_gene.`question_ID` = 97 /* Carry Gene */
	LEFT JOIN genwp_surveys_answer survey_carry_gene_answer
		ON survey_carry_gene_answer.`ID` = survey_carry_gene.`answer_ID`




// Get ineligible exercise
SELECT * FROM genwp_genesis_eligibility_result r
JOIN genwp_genesis_eligibility_result_answers a
	ON a.`result_id` = r.`id`
	AND question_id >= 21
	AND a.`answer` <> 2

// Users eligible with no linked account
SELECT	users.user_email, el.id, el.date_created, el.passcode, el.weight, el.height, el.age, el.bmi, 
	IF(el.is_eligible = 1, 'Yes', 'No') is_eligible,
	IF(el.high_speed_internet = 1, 'Yes', 'No') high_speed_internet,
	IF(ISNULL(el.can_understand_english), 'N/A', IF(el.can_understand_english = 1, 'Yes', 'No')) can_understand_english,
	q.`question`,
	IF(res.answer = 2, 'No', "Yes") answer,
	ud.*
	FROM `genwp_genesis_eligibility_result_answers` res
		LEFT JOIN `genwp_genesis_eligibility_result` el
			ON res.`result_id` = el.`id`
		INNER JOIN `genwp_genesis_eligibility_questions` q
			ON res.question_id = q.id
		INNER JOIN genwp_genesis_userdata ud
			ON ud.`eligibility_id` = el.id
		INNER JOIN genwp_users users
			ON ud.user_id = users.ID
	WHERE is_eligible = 1 
		AND (ud.`study_group` IS NULL OR ud.study_group = "") 

	ORDER BY el.id, q.`id`





